{% extends "base.html" %}

{% block title %}
New Purchase | The Money Game
{% endblock title %}

{% block content %}
<div class="wrapper">
    <h1>Enter the data for your new purchase</h1>
    {% if not daily_spending_bucket %}
    <p>You need to creating a Daily Spending bucket to use this app. <a href="/me">Create one now</a>.</p>
    {% else %}
    <p>Daily allowed spending: ${{ daily_spending_bucket.daily_amount }}</p>
    <form action="/purchases" method="POST">
        {% if request.query_params.get("bucket") %}
            {% set bucket_id = request.query_params.get("bucket") %}
        {% else %}
            {% set bucket_id = daily_spending_bucket.bucket_id %}
        {% endif %}
        <div class="input-group">
            <label for="amount">Amount</label>
            <input id="amount" name="amount" type="number" autofocus />
        </div>
        <div class="input-group">
            <label for="currency">Currency</label>
            <input id="currency" name="currency" type="text" value="TWD"/>
        </div>
        <div class="input-group">
            <label for="date">Date</label>
            <input id="date" name="date" type="date"  value="{{ default_date }}" />
        </div>
        <div class="input-group">
            <label for="time">Time</label>
            <input id="time" name="time" type="time" step="2" value="{{ default_time }}" />
        </div>
        <div class="input-group">
            <label for="timezone">Timezone</label>
            <input id="timezone" name="timezone" type="text" value="Asia/Taipei" readonly/>
        </div>
        <fieldset class="radio-group">
            {% for bucket in buckets %}
                <label class="radio">
                    <input type="radio" name="bucket" value="{{ bucket.bucket_id }}"/>
                    <span class="card">{{ bucket.name }}</span>
                </label>
            {% endfor %}
        </fieldset>
        <button type="submit">Save</button>
    </form>
    {% endif%}
</div>
{% endblock content %}